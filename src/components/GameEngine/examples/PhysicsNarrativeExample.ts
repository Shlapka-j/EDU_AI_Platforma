import { NarrativeActivity, DifficultyLevel, ActivityType } from '../../../types';
import { SceneBuilder } from '../SceneBuilder';

/**
 * P≈ô√≠klad pou≈æit√≠ Narrative Engine pro vytvo≈ôen√≠ fyzik√°ln√≠ho dobrodru≈æstv√≠
 * T√©ma: Gravitace a voln√Ω p√°d
 */

export function createPhysicsGravityAdventure(): NarrativeActivity {
  const sceneBuilder = new SceneBuilder();
  
  return sceneBuilder.createNarrativeActivity(
    'üåç Gravitaƒçn√≠ dobrodru≈æstv√≠',
    'Interaktivn√≠ p≈ô√≠bƒõh o gravitaci a voln√©m p√°du s praktick√Ωmi experimenty',
    {
      subject: 'physics',
      grade: 8,
      difficulty: DifficultyLevel.MEDIUM,
      educationalObjectives: [
        'Pochopit gravitaƒçn√≠ zrychlen√≠',
        'Aplikovat z√°kony voln√©ho p√°du',
        'Experimentovat s r≈Øzn√Ωmi hmotnostmi',
        'Mƒõ≈ôit ƒças a vzd√°lenost p≈ôi p√°du'
      ],
      estimatedDuration: 25, // minutes
      theme: 'gravity_exploration',
      includeMultimedia: true
    }
  );
}

/**
 * P≈ô√≠klad manu√°ln√≠ho vytvo≈ôen√≠ komplexn√≠ho narrativn√≠ho dobrodru≈æstv√≠
 */
export function createAdvancedPhysicsNarrative(): NarrativeActivity {
  return {
    id: 'physics_advanced_gravity_001',
    type: ActivityType.NARRATIVE_ADVENTURE,
    title: 'üèóÔ∏è Stavba vƒõ≈æe a gravitace',
    description: 'Komplexn√≠ fyzik√°ln√≠ dobrodru≈æstv√≠ kombinuj√≠c√≠ stavbu, mƒõ≈ôen√≠ a experimenty s gravitac√≠',
    content: {
      theme: 'engineering_physics',
      subject: 'physics',
      grade: 9
    },
    points: 200,
    difficulty: DifficultyLevel.HARD,
    learningObjectives: [
      'Aplikovat gravitaƒçn√≠ z√°kony p≈ôi stavbƒõ',
      'Optimalizovat konstrukce s ohledem na gravitaci',
      'Porozumƒõt vztahu mezi v√Ω≈°kou a potenci√°ln√≠ energi√≠',
      'Experimentovat s r≈Øzn√Ωmi materi√°ly a jejich p√°dem'
    ],
    startingSceneId: 'tower_intro',
    availableScenes: [
      {
        id: 'tower_intro',
        title: 'üèóÔ∏è √övod do stavebn√≠ho projektu',
        location: 'Stavebn√≠ plac ≈°koln√≠ vƒõ≈æe',
        description: 'Zaƒç√°tek ambici√≥zn√≠ho stavebn√≠ho projektu',
        text: 'Stoj√≠≈° p≈ôed z√°klady nov√© ≈°koln√≠ vƒõ≈æe. Jako hlavn√≠ in≈æen√Ωr m√°≈° za √∫kol navrhnout a postavit vƒõ≈æ, kter√° bude bezpeƒçn√° a √∫ƒçeln√°. Mus√≠≈° p≈ôitom br√°t v √∫vahu p≈Øsoben√≠ gravitace na v≈°echny ƒç√°sti konstrukce.',
        choices: [
          {
            id: 'analyze_foundation',
            text: 'Analyzovat zat√≠≈æen√≠ z√°klad≈Ø',
            description: 'Spoƒç√≠tat, jak gravitace p≈Øsob√≠ na celou konstrukci',
            nextSceneId: 'foundation_analysis',
            points: 25,
            educationalFeedback: 'V√Ωbornƒõ! Anal√Ωza z√°klad≈Ø je kl√≠ƒçov√° pro bezpeƒçnou stavbu.',
            difficulty: DifficultyLevel.HARD,
            actions: [
              {
                type: 'add_item',
                target: 'foundation_plans',
                value: true,
                message: 'üìê Z√≠skal jsi pl√°ny z√°klad≈Ø'
              }
            ]
          },
          {
            id: 'choose_materials',
            text: 'Vybrat stavebn√≠ materi√°ly',
            description: 'Rozhodnout o materi√°lech s ohledem na jejich hmotnost',
            nextSceneId: 'material_selection',
            points: 20,
            educationalFeedback: 'Dobr√° volba! Hmotnost materi√°l≈Ø ovliv≈àuje gravitaƒçn√≠ zat√≠≈æen√≠.',
            difficulty: DifficultyLevel.MEDIUM
          },
          {
            id: 'start_building',
            text: 'Rovnou zaƒç√≠t stavƒõt',
            description: 'Pustit se do stavby bez detailn√≠ p≈ô√≠pravy',
            nextSceneId: 'hasty_building',
            points: 5,
            consequence: 'Tv√° horlivost je chv√°lyhodn√°, ale in≈æen√Ωrsk√© projekty vy≈æaduj√≠ peƒçliv√© pl√°nov√°n√≠!',
            educationalFeedback: 'Pl√°nov√°n√≠ je v in≈æen√Ωrstv√≠ stejnƒõ d≈Øle≈æit√© jako samotn√° stavba.',
            difficulty: DifficultyLevel.EASY
          }
        ],
        educationalContent: {
          concept: 'Gravitaƒçn√≠ s√≠la v konstrukc√≠ch',
          explanation: 'Gravitace p≈Øsob√≠ na v≈°echny hmotn√© objekty smƒõrem dol≈Ø. Ve stavebnictv√≠ mus√≠me poƒç√≠tat s gravitaƒçn√≠m zat√≠≈æen√≠m, kter√© ovliv≈àuje stabilitu a bezpeƒçnost konstrukc√≠.',
          examples: [
            'V√Ωpoƒçet zat√≠≈æen√≠ z√°klad≈Ø budovy',
            'Volba vhodn√Ωch materi√°l≈Ø podle jejich hustoty',
            'Navrhov√°n√≠ podporov√Ωch konstrukc√≠'
          ],
          difficulty: DifficultyLevel.HARD,
          subject: 'physics'
        }
      },
      {
        id: 'foundation_analysis',
        title: 'üìê Anal√Ωza z√°klad≈Ø',
        location: 'In≈æen√Ωrsk√° kancel√°≈ô',
        description: 'Detailn√≠ v√Ωpoƒçty gravitaƒçn√≠ho zat√≠≈æen√≠',
        text: 'Sed√≠≈° u v√Ωpoƒçetn√≠ho stolu se slo≈æit√Ωmi rovnicemi. P≈ôed tebou jsou pl√°ny vƒõ≈æe a kalkulaƒçka. Mus√≠≈° spoƒç√≠tat, jakou silou bude gravitace p≈Øsobit na z√°klady vƒõ≈æe v z√°vislosti na v√Ω≈°ce a pou≈æit√Ωch materi√°lech.',
        choices: [
          {
            id: 'calculate_steel',
            text: 'Spoƒç√≠tat zat√≠≈æen√≠ pro ocelovou konstrukci',
            description: 'Pou≈æ√≠t hustotu oceli (7850 kg/m¬≥) pro v√Ωpoƒçty',
            nextSceneId: 'steel_calculations',
            points: 30,
            actions: [
              {
                type: 'add_item',
                target: 'steel_calculations',
                value: true,
                message: 'üîß Dokonƒçil jsi v√Ωpoƒçty pro ocel'
              },
              {
                type: 'set_flag',
                target: 'material_choice',
                value: 'steel'
              }
            ],
            educationalFeedback: 'V√Ωbornƒõ! Ocel m√° vysokou pevnost, ale je tak√© tƒõ≈æk√° - gravitaƒçn√≠ zat√≠≈æen√≠ bude znaƒçn√©.',
            difficulty: DifficultyLevel.HARD
          },
          {
            id: 'calculate_concrete',
            text: 'Spoƒç√≠tat zat√≠≈æen√≠ pro betonovou konstrukci',
            description: 'Pou≈æ√≠t hustotu betonu (2400 kg/m¬≥) pro v√Ωpoƒçty',
            nextSceneId: 'concrete_calculations',
            points: 25,
            actions: [
              {
                type: 'add_item',
                target: 'concrete_calculations',
                value: true,
                message: 'üèóÔ∏è Dokonƒçil jsi v√Ωpoƒçty pro beton'
              },
              {
                type: 'set_flag',
                target: 'material_choice',
                value: 'concrete'
              }
            ],
            educationalFeedback: 'Dobr√° volba! Beton je st≈ôednƒõ tƒõ≈æk√Ω a m√° dobrou pevnost v tlaku.',
            difficulty: DifficultyLevel.MEDIUM
          },
          {
            id: 'use_formula',
            text: 'Pou≈æ√≠t obecn√Ω vzorec F = m √ó g',
            description: 'Aplikovat z√°kladn√≠ gravitaƒçn√≠ vzorec',
            nextSceneId: 'formula_application',
            points: 20,
            educationalFeedback: 'Spr√°vnƒõ! F = m √ó g je z√°kladn√≠ vzorec pro v√Ωpoƒçet gravitaƒçn√≠ s√≠ly.',
            difficulty: DifficultyLevel.EASY
          }
        ],
        conditions: [
          {
            type: 'item',
            key: 'foundation_plans',
            value: true,
            operator: '=='
          }
        ],
        educationalContent: {
          concept: 'V√Ωpoƒçet gravitaƒçn√≠ho zat√≠≈æen√≠',
          explanation: 'Gravitaƒçn√≠ s√≠la F = m √ó g, kde m je hmotnost objektu a g je gravitaƒçn√≠ zrychlen√≠ (9,81 m/s¬≤). Pro stavby mus√≠me poƒç√≠tat s celkovou hmotnost√≠ v≈°ech materi√°l≈Ø.',
          examples: [
            'V√Ωpoƒçet hmotnosti betonov√© desky: V √ó œÅ √ó g',
            'Zat√≠≈æen√≠ ocelov√© konstrukce: d√©lka √ó pr≈Ø≈ôez √ó hustota √ó g',
            'Bezpeƒçnostn√≠ koeficienty pro r≈Øzn√© materi√°ly'
          ],
          difficulty: DifficultyLevel.HARD,
          subject: 'physics'
        }
      },
      {
        id: 'material_selection',
        title: 'üß± V√Ωbƒõr materi√°l≈Ø',
        location: 'Stavebn√≠ sklad',
        description: 'Volba vhodn√Ωch stavebn√≠ch materi√°l≈Ø',
        text: 'Proch√°z√≠≈° skladem pln√Ωm r≈Øzn√Ωch stavebn√≠ch materi√°l≈Ø. Ka≈æd√Ω m√° jin√© vlastnosti - hmotnost, pevnost, cenu. Tv√© rozhodnut√≠ ovlivn√≠, jak bude gravitace p≈Øsobit na vƒõ≈æ a jak√° bude jej√≠ stabilita.',
        choices: [
          {
            id: 'lightweight_materials',
            text: 'Vybrat lehk√© materi√°ly (hlin√≠k, kompozity)',
            description: 'Minimalizovat gravitaƒçn√≠ zat√≠≈æen√≠',
            nextSceneId: 'lightweight_construction',
            points: 25,
            actions: [
              {
                type: 'set_flag',
                target: 'construction_weight',
                value: 'light'
              },
              {
                type: 'add_item',
                target: 'aluminum_beams',
                value: true,
                message: '‚ú® Z√≠skal jsi hlin√≠kov√© nosn√≠ky'
              }
            ],
            educationalFeedback: 'Chytr√° volba! Lehk√© materi√°ly sni≈æuj√≠ gravitaƒçn√≠ zat√≠≈æen√≠ z√°klad≈Ø.',
            difficulty: DifficultyLevel.MEDIUM
          },
          {
            id: 'balanced_materials',
            text: 'Zvolit vyv√°≈æenou kombinaci materi√°l≈Ø',
            description: 'Optim√°ln√≠ pomƒõr v√°hy, pevnosti a ceny',
            nextSceneId: 'balanced_construction',
            points: 30,
            actions: [
              {
                type: 'set_flag',
                target: 'construction_weight',
                value: 'balanced'
              },
              {
                type: 'add_points',
                target: 'engineering_bonus',
                value: 15,
                message: '‚öñÔ∏è Bonus za vyv√°≈æenost!'
              }
            ],
            educationalFeedback: 'V√Ωbornƒõ! In≈æen√Ωrsk√© ≈ôe≈°en√≠ ƒçasto spoƒç√≠v√° v nalezen√≠ optim√°ln√≠ rovnov√°hy.',
            difficulty: DifficultyLevel.HARD
          },
          {
            id: 'heavy_materials',
            text: 'Pou≈æ√≠t tƒõ≈æk√©, pevn√© materi√°ly (ocel, beton)',
            description: 'Maxim√°ln√≠ pevnost za cenu vysok√© hmotnosti',
            nextSceneId: 'heavy_construction',
            points: 20,
            actions: [
              {
                type: 'set_flag',
                target: 'construction_weight',
                value: 'heavy'
              }
            ],
            educationalFeedback: 'Pevn√© materi√°ly jsou dobr√©, ale vy≈æaduj√≠ silnƒõj≈°√≠ z√°klady kv≈Øli gravitaci.',
            difficulty: DifficultyLevel.MEDIUM
          }
        ],
        educationalContent: {
          concept: 'Materi√°lov√© vlastnosti a gravitace',
          explanation: 'Ka≈æd√Ω stavebn√≠ materi√°l m√° svou hustotu, kter√° urƒçuje, jak silnƒõ na nƒõj p≈Øsob√≠ gravitace. Hustota √ó objem √ó g = gravitaƒçn√≠ s√≠la.',
          examples: [
            'Hlin√≠k: 2700 kg/m¬≥ - lehk√Ω, ale drah√Ω',
            'Ocel: 7850 kg/m¬≥ - pevn√°, ale tƒõ≈æk√°',
            'Beton: 2400 kg/m¬≥ - dostupn√Ω, st≈ôedn√≠ vlastnosti'
          ],
          difficulty: DifficultyLevel.MEDIUM,
          subject: 'physics'
        }
      },
      {
        id: 'tower_testing',
        title: 'üß™ Testov√°n√≠ vƒõ≈æe',
        location: 'Hotov√° vƒõ≈æ - testovac√≠ plo≈°ina',
        description: 'Experimenty s dokonƒçenou vƒõ≈æ√≠',
        text: 'Vƒõ≈æ je hotov√°! Nyn√≠ je ƒças otestovat, jak dob≈ôe funguje. M√°≈° k dispozici r≈Øzn√© p≈ôedmƒõty, kter√© m≈Ø≈æe≈° spustit z r≈Øzn√Ωch v√Ω≈°ek vƒõ≈æe a pozorovat, jak gravitace ovliv≈àuje jejich p√°d.',
        choices: [
          {
            id: 'drop_test_light',
            text: 'Spustit lehk√© p≈ôedmƒõty (pero, pap√≠r)',
            description: 'Test s objekty mal√© hmotnosti',
            nextSceneId: 'light_object_results',
            points: 15,
            educationalFeedback: 'Zaj√≠mav√©! Lehk√© p≈ôedmƒõty jsou v√≠ce ovlivnƒõny odporem vzduchu.',
            difficulty: DifficultyLevel.EASY
          },
          {
            id: 'drop_test_heavy',
            text: 'Spustit tƒõ≈æk√© p≈ôedmƒõty (k√°men, kov)',
            description: 'Test s objekty velk√© hmotnosti',
            nextSceneId: 'heavy_object_results',
            points: 20,
            educationalFeedback: 'V√Ωbornƒõ! Tƒõ≈æk√© p≈ôedmƒõty l√©pe demonstruuj√≠ ƒçistou gravitaci.',
            difficulty: DifficultyLevel.MEDIUM
          },
          {
            id: 'measure_time',
            text: 'P≈ôesnƒõ mƒõ≈ôit ƒçasy p√°du stopkami',
            description: 'Vƒõdeck√Ω p≈ô√≠stup s p≈ôesn√Ωmi mƒõ≈ôen√≠mi',
            nextSceneId: 'precise_measurements',
            points: 35,
            actions: [
              {
                type: 'add_item',
                target: 'measurement_data',
                value: true,
                message: 'üìä Z√≠skal jsi p≈ôesn√° data o p√°du'
              }
            ],
            educationalFeedback: 'Skvƒõl√©! P≈ôesn√° mƒõ≈ôen√≠ jsou z√°kladem vƒõdeck√©ho zkoum√°n√≠.',
            difficulty: DifficultyLevel.HARD
          }
        ],
        conditions: [
          {
            type: 'visited',
            key: 'foundation_analysis',
            value: true,
            operator: '=='
          }
        ],
        educationalContent: {
          concept: 'Experiment√°ln√≠ ovƒõ≈ôen√≠ gravitaƒçn√≠ch z√°kon≈Ø',
          explanation: 'Experimentov√°n√≠ n√°m umo≈æ≈àuje ovƒõ≈ôit teoretick√© poznatky o gravitaci. Vzorec h = ¬Ωgt¬≤ popisuje dr√°hu voln√©ho p√°du.',
          examples: [
            'Mƒõ≈ôen√≠ ƒçasu p√°du z r≈Øzn√Ωch v√Ω≈°ek',
            'Porovn√°n√≠ p√°du r≈Øznƒõ tƒõ≈æk√Ωch objekt≈Ø',
            'Vliv odporu vzduchu na p√°d'
          ],
          difficulty: DifficultyLevel.MEDIUM,
          subject: 'physics'
        }
      },
      {
        id: 'project_completion',
        title: 'üéØ Dokonƒçen√≠ projektu',
        location: 'Slavnostn√≠ p≈ôed√°n√≠ vƒõ≈æe',
        description: '√öspƒõ≈°n√© zakonƒçen√≠ stavebn√≠ho projektu',
        text: 'Gratulujeme! √öspƒõ≈°nƒõ jsi dokonƒçil stavbu vƒõ≈æe a provedl v≈°echny pot≈ôebn√© testy. Tv√© pochopen√≠ gravitace a jej√≠ho vlivu na stavby je nyn√≠ mnohem hlub≈°√≠. Vƒõ≈æ stoj√≠ pevnƒõ a bezpeƒçnƒõ d√≠ky tv√Ωm spr√°vn√Ωm v√Ωpoƒçt≈Øm.',
        choices: [],
        isEnding: true,
        rewards: [
          {
            type: 'badge',
            value: 'master_engineer',
            message: 'üèóÔ∏è Z√≠skal jsi odznak Mistr in≈æen√Ωr!'
          },
          {
            type: 'xp',
            value: 150,
            message: '‚≠ê Bonus 150 XP za dokonƒçen√≠ slo≈æit√©ho projektu!'
          }
        ],
        educationalContent: {
          concept: 'Aplikace fyziky v in≈æen√Ωrstv√≠',
          explanation: 'Dokonƒçil jsi komplexn√≠ projekt, kter√Ω kombinoval teoretick√© znalosti gravitace s praktickou aplikac√≠ v stavebnictv√≠.',
          difficulty: DifficultyLevel.HARD,
          subject: 'physics'
        }
      }
    ],
    maxChoices: 12,
    educationalObjectives: [
      'Aplikovat gravitaƒçn√≠ z√°kony p≈ôi stavbƒõ',
      'Optimalizovat konstrukce s ohledem na gravitaci',
      'Porozumƒõt vztahu mezi v√Ω≈°kou a potenci√°ln√≠ energi√≠',
      'Experimentovat s r≈Øzn√Ωmi materi√°ly a jejich p√°dem'
    ]
  };
}

/**
 * Helper funkce pro vytvo≈ôen√≠ rychl√©ho demo narrative
 */
export function createQuickPhysicsDemo(): NarrativeActivity {
  const sceneBuilder = new SceneBuilder();
  
  const quickScene1 = sceneBuilder.createQuickScene(
    'üéà Padaj√≠c√≠ bal√≥nek',
    'Dr≈æ√≠≈° v ruce bal√≥nek naplnƒõn√Ω heliem. Co se stane, kdy≈æ ho pust√≠≈°?',
    [
      { text: 'Bal√≥nek polet√≠ nahoru', nextSceneId: 'balloon_up', points: 20 },
      { text: 'Bal√≥nek spadne dol≈Ø', nextSceneId: 'balloon_down', points: 5 },
      { text: 'Bal√≥nek z≈Østane na m√≠stƒõ', nextSceneId: 'balloon_static', points: 10 }
    ]
  );

  const quickScene2 = sceneBuilder.createQuickScene(
    '‚ú® V√Ωsledek experimentu',
    'Bal√≥nek skuteƒçnƒõ let√≠ nahoru! Helium je lehƒç√≠ ne≈æ vzduch, tak≈æe vztlakov√° s√≠la vzduchu je vƒõt≈°√≠ ne≈æ gravitaƒçn√≠ s√≠la p≈Øsob√≠c√≠ na bal√≥nek.',
    [
      { text: 'Zkusit dal≈°√≠ experiment', nextSceneId: 'scene_1', points: 10 }
    ]
  );

  quickScene2.id = 'balloon_up';
  quickScene2.isEnding = true;

  return {
    id: 'quick_physics_demo',
    type: ActivityType.NARRATIVE_ADVENTURE,
    title: 'üß™ Rychl√© fyzik√°ln√≠ demo',
    description: 'Kr√°tk√© demo narrative engine s fyzik√°ln√≠m obsahem',
    content: { subject: 'physics', grade: 6 },
    points: 50,
    difficulty: DifficultyLevel.EASY,
    learningObjectives: ['Pochopit vztlakovou s√≠lu', 'Porovnat r≈Øzn√© s√≠ly'],
    startingSceneId: quickScene1.id,
    availableScenes: [quickScene1, quickScene2],
    maxChoices: 3,
    educationalObjectives: ['Pochopit vztlakovou s√≠lu', 'Porovnat r≈Øzn√© s√≠ly']
  };
}